---
const { title, description, image, articleDate } = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const socialImageURL = new URL(image || '/default-og.png', Astro.site);
const siteName = "GTB 매거진";
---

<html lang="ko">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="generator" content={Astro.generator} />
		<link rel="canonical" href={canonicalURL} />
		<link rel="sitemap" href="/sitemap-index.xml" />
		
		<!-- 구글 서치 콘솔 인증 태그 -->
		<meta name="google-site-verification" content="dVREzh12msPygEY4GFmy3lTwOJv-J40F9NoT_3n4ZdM" />

		<!-- Meta Tags -->
		<title>{title ? `${title} | GTB 매거진` : "GTB 매거진 - 최신 트렌드 & 정보"}</title>
		<meta name="description" content={description || "해외 최신 트렌드와 IT, 건강 정보를 가장 빠르게 전달합니다."} />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:title" content={title || "GTB 매거진"} />
		<meta property="og:description" content={description || "해외 최신 트렌드와 IT, 건강 정보를 가장 빠르게 전달합니다."} />
		<meta property="og:image" content={socialImageURL} />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={canonicalURL} />
		<meta property="twitter:title" content={title || "GTB 매거진"} />
		<meta property="twitter:description" content={description || "해외 최신 트렌드와 IT, 건강 정보를 가장 빠르게 전달합니다."} />
		<meta property="twitter:image" content={socialImageURL} />

		<link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
		<style is:global>
			:root { --primary: #111827; --accent: #2563eb; --text-main: #1f2937; --text-sub: #6b7280; --bg-body: #ffffff; }
			body { font-family: 'Pretendard', sans-serif; background-color: var(--bg-body); color: var(--text-main); margin: 0; line-height: 1.6; }
			.container { max-width: 1000px; margin: 0 auto; padding: 0 1.5rem; }
			header { background: white; border-bottom: 1px solid #f3f4f6; padding: 1.5rem 0; position: relative; }
			.header-inner { display: flex; justify-content: space-between; align-items: center; }
			.logo { font-size: 1.5rem; font-weight: 900; color: var(--primary); letter-spacing: -1px; }
			.nav-links a { margin-left: 2rem; font-weight: 600; color: var(--text-main); }
			footer { border-top: 1px solid #f3f4f6; padding: 4rem 0; margin-top: 5rem; text-align: center; }
		</style>
	</head>
	<body>
		<header>
			<div class="container header-inner">
				<a href="/" class="logo">GTB 매거진</a>
				<nav class="nav-links">
					<a href="/">홈</a>
					<a href="/category/IT테크">IT·테크</a>
					<a href="/category/건강">건강</a>
					<a href="/category/라이프">라이프</a>
				</nav>
			</div>
		</header>
		<main>
			<slot />
		</main>
		<footer>
			<p>GTB 매거진 &copy; 2026. All rights reserved.</p>
		</footer>

		<!-- 실시간 트래킹 스크립트 -->
		<script>
			// 1. 페이지 방문 기록
			fetch('/api/track', {
				method: 'POST',
				body: JSON.stringify({ type: 'visit', path: window.location.pathname }),
				headers: { 'Content-Type': 'application/json' }
			});

			// 2. 쿠팡 링크 클릭 기록
			document.addEventListener('click', (e) => {
				const link = e.target.closest('a');
				if (link && (link.href.includes('link.coupang.com') || link.innerText.includes('쿠팡'))) {
					fetch('/api/track', {
						method: 'POST',
						body: JSON.stringify({ 
							type: 'click', 
							path: window.location.pathname, 
							label: link.innerText.trim() 
						}),
						headers: { 'Content-Type': 'application/json' }
					});
				}
			});
		</script>
	</body>
</html>
